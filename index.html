<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>ARK Dino Tracker</title>
<style>
  body { font-family: Arial; margin: 20px; background: #111; color: #fff; }
  .login-btn, .logout-btn { padding: 8px 14px; background: #4CAF50; border: none; cursor: pointer; }
  .logout-btn { background: #e74c3c; }
  .dino-list { margin-top: 20px; }
  label { display: block; margin: 5px 0; }
</style>
</head>
<body>

<h1>ARK Dino Tracker</h1>

<button id="loginBtn" class="login-btn">Login with Google</button>
<button id="logoutBtn" class="logout-btn" style="display:none;">Logout</button>

<p id="userDisplay"></p>

<div class="dino-list" id="dinoContainer" style="display:none;">
  <h2>Creatures</h2>
  <label><input type="checkbox" data-name="Achatina"> Achatina</label>
  <label><input type="checkbox" data-name="Allosaurus"> Allosaurus</label>
  <label><input type="checkbox" data-name="Ankylosaurus"> Ankylosaurus</label>
  <label><input type="checkbox" data-name="Argentavis"> Argentavis</label>
  <label><input type="checkbox" data-name="Rex"> Rex</label>
  <label><input type="checkbox" data-name="Spino"> Spino</label>
  <label><input type="checkbox" data-name="Yutyrannus"> Yutyrannus</label>
</div>

<script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-auth.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-firestore.js"></script>

<script>
const firebaseConfig = {
  apiKey: "AIzaSyAMLeQfaP3gySD5zFXJX1GS5m0Erla4w7g",
  authDomain: "ark-dino-tracker.firebaseapp.com",
  projectId: "ark-dino-tracker",
};

const app = firebase.initializeApp(firebaseConfig);
const auth = firebase.auth();
const db = firebase.firestore();

const loginBtn = document.getElementById("loginBtn");
const logoutBtn = document.getElementById("logoutBtn");
const userDisplay = document.getElementById("userDisplay");
const dinoContainer = document.getElementById("dinoContainer");

loginBtn.onclick = () => {
  const provider = new firebase.auth.GoogleAuthProvider();
  auth.signInWithPopup(provider);
};

logoutBtn.onclick = () => auth.signOut();

auth.onAuthStateChanged(async (user) => {
  if (user) {
    userDisplay.innerText = "Logged in as: " + user.email;
    loginBtn.style.display = "none";
    logoutBtn.style.display = "inline-block";
    dinoContainer.style.display = "block";

    const docRef = db.collection("users").doc(user.uid);
    const docSnap = await docRef.get();
    const data = docSnap.exists ? docSnap.data().dinos || [] : [];

    document.querySelectorAll("input[type='checkbox']").forEach(cb => {
      cb.checked = data.includes(cb.dataset.name);
      cb.onchange = async () => {
        const newList = [...document.querySelectorAll("input:checked")].map(x => x.dataset.name);
        await docRef.set({ dinos: newList });
      };
    });

  } else {
    userDisplay.innerText = "";
    loginBtn.style.display = "inline-block";
    logoutBtn.style.display = "none";
    dinoContainer.style.display = "none";
  }
});
</script>

</body>
</html>
